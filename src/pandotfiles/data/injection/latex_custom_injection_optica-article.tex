%% Select the journal you're submitting to
%% oe, boe, ome, osac, osajournal
\journal{opticajournal}
\articletype{Research Article}

% \providecommand{\tightlist}{%
% \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Key:
% Express journals must have the correct journal selected:
% {oe} Optics Express
% {boe} Biomedical Optics Express
% {ome} Optical Material Express
% {osac} OSAC Continuum
% Other OSA journals may use:
% {osajournal} Applied Optics, Advances in Optics and Photonics, Journal of the Optical Society of America A/B, Optics Letters, Optica, Photonics Research

% Uncomment if submitting to Photonics Research.
% ONLY APPLICABLE FOR \journal{osajournal}
% \setprjcopyright

\usepackage{siunitx}
\usepackage{float}
\floatplacement{figure}{t}
\makeatletter
  $if(float_placement)$\def\fps@figure{ $float_placement$}$endif$
  $if(float_placement)$\def\fps@table{ $float_placement$}$endif$
\makeatother
% \setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\ifthenelse{\equal{$lineno$}{}}{}{
  \usepackage{lineno}
}
%\usepackage{amsmath,amsfonts,amssymb}

\ifthenelse{\equal{$lineno$}{}}{}{
%% Patch 'normal' math environments:
\usepackage{etoolbox} %% <- for \pretocmd, \apptocmd and \patchcmd
\newcommand*\linenomathpatch[1]{%
  \cspreto{#1}{\linenomath}%
  \cspreto{#1*}{\linenomath}%
  \csappto{end#1}{\endlinenomath}%
  \csappto{end#1*}{\endlinenomath}%
}
%% Patch AMS math environments:
\newcommand*\linenomathpatchAMS[1]{%
  \cspreto{#1}{\linenomathAMS}%
  \cspreto{#1*}{\linenomathAMS}%
  \csappto{end#1}{\endlinenomath}%
  \csappto{end#1*}{\endlinenomath}%
}

%% Definition of \linenomathAMS depends on whether the mathlines option is provided
\expandafter\ifx\linenomath\linenomathWithnumbers
  \let\linenomathAMS\linenomathWithnumbers
  %% The following line gets rid of an extra line numbers at the bottom:
  \patchcmd\linenomathAMS{\advance\postdisplaypenalty\linenopenalty}{}{}{}
\else
  \let\linenomathAMS\linenomathNonumbers
\fi

\linenomathpatch{equation}
\linenomathpatchAMS{gather}
\linenomathpatchAMS{multline}
\linenomathpatchAMS{align}
\linenomathpatchAMS{alignat}
\linenomathpatchAMS{flalign}
}


\renewcommand{\maketitle}{


    \title{$title$}

    $if(author)$\author{$for(author/allbutlast)$$it.name$,$if(it.affil)$\authormark{$it.affil$}$endif$$endfor$ and $for(author/last)$$it.name$$if(it.affil)$\authormark{$it.affil$}$endif$$endfor$}
    $endif$

        $if(affil)$
        \address{
            $for(affil)$\authormark{$affil.id$}$affil.content$$sep$\\
                $endfor$}
    $endif$

        \ifthenelse{\equal{$email$}{}}{
            \email{address is needed} %% email address is required
        }{
            \email{\authormark{*}$email$} %% email address is required
        }

}

% Docstyle injection
\ifthenelse{\equal{$lineno$}{}}{}{
  \linenumbers
}

